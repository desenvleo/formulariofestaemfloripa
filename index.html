<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INSCRIÇÃO</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <header>
        <div>
            <h1>ROLEZINHO D48 - FUNK, MEGAFUNK E MANDELÃO</h1>
            <h2>Preencha os campos abaixo e garanta sua presença!</h2>
        </div>
    </header>
    <main>
        <section class="container">
            <section class="infos">
                <h3>BENEFÍCIOS E INFORMAÇÕES</h3>
                <p>A cada 4 ingressos comprados são liberadas 2 cortesias! <img src="./imagem/ticket.png"
                        alt="imgingresso"><br>Basta enviar os nomes e
                    e-mails, especificando quem são os ganhadores!</p>
                <p class="valor"><img src="./imagem/ticket.png" alt="imgingresso">1 ingresso - R$30,00<br><img
                        src="./imagem/ticket.png" alt="imgingresso">4 ingressos - R$100,00</p>
                <p class="pix">Chave Pix: leonardodemouraveiga@gmail.com <br>(NU PAGAMENTOS)</p>

            </section>
            <section class="formulario">
                <div class="divform">
                    <form id="meuForm" enctype="multipart/form-data"
                        action="https://script.google.com/macros/s/AKfycbwW_cIY_6XtBfBMmMrpYu3GwOiLA924Oje69fP3NgaR04YawyQDscXY3QJ2n1mWgk1Efw/exec"
                        onsubmit="return enviarForm(this)">
                        <label for="nomes">Envie no máximo 12 nomes por formulário: <textarea name="nomes"
                                id="caixanomes" cols="50" rows="10"></textarea></label>
                        <label for="email">E-mail(s) correspondentes: <textarea name="emails" id="" cols="20"
                                rows="5"></textarea></label>
                        <label for="arquivo" class="labelwrapper">Comprovante(s): <input class="file" type="file"
                                name="comprovante" id="caixacomprov"> <button id="comprovante"
                                type="submit">Enviar</button></label>

                    </form>
                </div>
            </section>
        </section>
    </main>
    <footer class="footer">
        <h4>Design criado por Leonnardo de Moura - Desenvolvedor</h4>
        <p>Entre em contato: <a target="_blank" href="https://wa.me/5548991286349">Chamar promoter <img
                    src="./imagem/whatsssss.png" alt=""></a></p>
        <p>LOCAL DO EVENTO: STAGE MUSIC PARK - FLORIANÓPOLIS, SANTA CATARINA</p>
    </footer>

    <script>

        document.querySelectorAll('.footer a').forEach(a => {
            a.addEventListener('touchstart', () => a.classList.add('touch'));
            a.addEventListener('touchend', () => a.classList.remove('touch'));
            a.addEventListener('touchcancel', () => a.classList.remove('touch'));
        });


        document.getElementById("meuForm").addEventListener("submit", function (e) {
            e.preventDefault(); // evita envio padrão

            const form = e.target;
            const fileInput = document.getElementById("caixacomprov");
            const file = fileInput.files[0];

            // Lê o arquivo em base64
            if (file) {
                const reader = new FileReader();
                reader.onload = function (event) {
                    const base64Data = event.target.result.split(",")[1];

                    enviarDados(form, file.name, file.type, base64Data);
                };
                reader.readAsDataURL(file);
            } else {
                // Se não tiver arquivo
                enviarDados(form, "", "", "");
            }
        });

        function enviarDados(form, fileName, mimeType, fileData) {
            const payload = {
                nomes: form.nomes.value,
                emails: form.emails.value,
                fileName: fileName,
                mimeType: mimeType,
                fileData: fileData
            };

            fetch(form.action, {
                method: "POST",
                body: new URLSearchParams(payload)
            })
                .then(r => r.json())
                .then(res => {
                    if (res.result === "success") {
                        alert("Formulário enviado com sucesso!");
                        form.reset();
                    } else {
                        alert("Erro: " + res.message);
                    }
                })
                .catch(err => alert("Falha na conexão: " + err));
        }

        // Footer: efeito touch nos links (mantendo seu código)
        document.querySelectorAll('.footer a').forEach(a => {
            a.addEventListener('touchstart', () => a.classList.add('touch'));
            a.addEventListener('touchend', () => a.classList.remove('touch'));
            a.addEventListener('touchcancel', () => a.classList.remove('touch'));
        });



    </script>




</body>

</html>